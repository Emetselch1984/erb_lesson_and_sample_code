# 達人に学ぶSQL指南書
## ウィンドウ構文
### 要件
過去の直近に日付を求める
| sample_date |load_val|
| ---- | ---- |
|2018-02-01|1024|
|2018-02-02|2366|
|2018-02-05|2366|
|2018-02-07|985|
|2018-02-08|780|
|2018-02-12|1000|
### 結果
| cur_date |latest_date|
| ---- | ---- |
|2018-02-01|
|2018-02-02|2018-02-01|
|2018-02-05|2018-02-02|
|2018-02-07|2018-02-015|
|2018-02-08|2018-02-07|
|2018-02-12|2018-02-08|

## 直後の日付とデータを求める
フレームを後ろに移動させる
### 結果
| cur_date |cur_load | next_date | next_load |
| ---- | ---- | ---- | ---- |
|2018-02-01| 1024 | 2018-02-02 | 2366 | 
|2018-02-02| 2366 | 2018-02-05 | 2366 | 
|2018-02-05| 2366 | 2018-02-07 |  985 | 
|2018-02-07|  985 | 2018-02-08 |  780 | 
|2018-02-08|  780 | 2018-02-12 | 1000 | 
|2018-02-12| 1000 | 

## 1日前の日付とデータを表示
| cur_date |cur_load | day1_before | load_day1_before |
| ---- | ---- | ---- | ---- |
|2018-02-01| 1024 |  |  | 
|2018-02-02| 2366 | 2018-02-01 | 1024 | 
|2018-02-05| 2366 |  |  | 
|2018-02-07|  985 |  |  | 
|2018-02-08|  780 | 2018-02-7 | 985 | 
|2018-02-12| 1000 | 

## 3つ前の日付を表示
| cur_date | latest_1 | latest_2 | latest_3 |
| ---- | ---- | ---- | ---- |
|2018-02-01|  |  |  | 
|2018-02-02| 2018-02-01 |  |  | 
|2018-02-05| 2018-02-02 | 2018-02-01 |  | 
|2018-02-07| 2018-02-05 | 2018-02-02 | 2018-02-01 | 
|2018-02-08| 2018-02-07 | 2018-02-05 | 2018-02-02 | 
|2018-02-12| 2018-02-08 | 2018-02-07 | 2018-02-05 |